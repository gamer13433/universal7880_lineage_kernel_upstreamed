--- lib/asn1_decoder.c
+++ lib/asn1_decoder.c
@@ -208,8 +206,9 @@ next_op:
 		unsigned char tmp;
 
 		/* Skip conditional matches if possible */
-		if ((op & ASN1_OP_MATCH__COND && flags & FLAG_MATCHED) ||
-		    (op & ASN1_OP_MATCH__SKIP && dp == datalen)) {
+		if ((op & ASN1_OP_MATCH__COND &&
+		     flags & FLAG_MATCHED) ||
+		    dp == datalen) {
 			pc += asn1_op_lengths[op];
 			goto next_op;
 		}
@@ -218,7 +217,7 @@ next_op:
 		hdr = 2;
 
 		/* Extract a tag from the data */
-		if (unlikely(datalen - dp < 2))
+		if (unlikely(dp >= datalen - 1))
 			goto data_overrun_error;
 		tag = data[dp++];
 		if (unlikely((tag & 0x1f) == ASN1_LONG_TAG))
@@ -264,7 +263,7 @@ next_op:
 				int n = len - 0x80;
 				if (unlikely(n > 2))
 					goto length_too_long;
-				if (unlikely(n > datalen - dp))
+				if (unlikely(dp >= datalen - n))
 					goto data_overrun_error;
 				hdr += n;
 				for (len = 0; n > 0; n--) {
@@ -417,8 +413,6 @@ next_op:
 			else
 				act = machine[pc + 1];
 			ret = actions[act](context, hdr, 0, data + tdp, len);
-			if (ret < 0)
-				return ret;
 		}
 		pc += asn1_op_lengths[op];
 		goto next_op;
