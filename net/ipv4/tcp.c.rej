--- net/ipv4/tcp.c
+++ net/ipv4/tcp.c
@@ -2585,13 +2585,10 @@ static int do_tcp_setsockopt(struct sock *sk, int level,
 
 	case TCP_FASTOPEN:
 		if (val >= 0 && ((1 << sk->sk_state) & (TCPF_CLOSE |
-		    TCPF_LISTEN))) {
-			tcp_fastopen_init_key_once(true);
-
+		    TCPF_LISTEN)))
 			err = fastopen_init_queue(sk, val);
-		} else {
+		else
 			err = -EINVAL;
-		}
 		break;
 	case TCP_TIMESTAMP:
 		if (!tp->repair)
