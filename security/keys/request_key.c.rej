--- security/keys/request_key.c
+++ security/keys/request_key.c
@@ -414,7 +391,6 @@ link_check_failed:
 
 link_prealloc_failed:
 	mutex_unlock(&user->cons_lock);
-	key_put(key);
 	kleave(" = %d [prelink]", ret);
 	return ret;
 
@@ -440,18 +416,11 @@ static struct key *construct_key_and_link(struct keyring_search_context *ctx,
 
 	kenter("");
 
-	ret = construct_get_dest_keyring(&dest_keyring);
-	if (ret)
-		goto error;
-
-	if (ctx->index_key.type == &key_type_keyring)
-		return ERR_PTR(-EPERM);
+	user = key_user_lookup(current_fsuid());
+	if (!user)
+		return ERR_PTR(-ENOMEM);
 
-	user = key_user_lookup(current_fsuid());
-	if (!user) {
-		ret = -ENOMEM;
-		goto error_put_dest_keyring;
-	}
+	construct_get_dest_keyring(&dest_keyring);
 
 	ret = construct_alloc_key(ctx, dest_keyring, flags, user, &key);
 	key_user_put(user);
